<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="Assets\css\sign.style.css" />
  </head>
  <body>
    <div class="whole">
      <div class="sign-up">
        <h1>Sign-up</h1>
        <form id="form">
          <div class="change">
            <label>Name:</label>
            <input
              class="input"
              id="fname"
              type="text"
              title="Firstname required"
              autocomplete="sdfsdf"
              value="yazhan"
              pattern="[A-Za-z]{1,32}"
              required
            />
          </div>
          <div class="change">
            <label> Middle Name:</label>
            <input
              class="input"
              id="mname"
              type="text"
              title="middlename required"
              pattern="[A-Za-z]{1,32}"
              
            />
          </div>
          <div class="change">
            <label>Last Name:</label>
            <input
              class="input"
              id="Lname"
              type="text"
              title="lastname required"
              value = "jayaprakash"
              pattern="[A-Za-z]{1,32}"
      
            />
          </div>
          <div class="change">
            <label>E-mail id:</label>
            <input
              class="input"
              id="email"
              required
              type="email"
              value="yazhanj@gmail.com"
              name="requiredemail"
              required
            />
          </div>
          <div class="change">
            <label>Phone Number:</label>
            <input
              class="input"
              id="phnumber"
              type="text"
              value="8122793940"
              title="phonenumber required"
              pattern="[6-9]{1}[0-9]{9}"
              maxlength="10"
              required
            />
          </div>
          <div class="change">
            <label>Age:</label>
            <input
              class="input"
              id="age"
              type="text"
              title="age required"
            
              value="20"
              pattern="[0-9]{2}"
              maxlength="2"
              required
            />

          <div class="change">
            <label>Password:</label>
            <input
              class="input"
              type="password"
              id="password"
              value="As123456"
              pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"         
              title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters"
              required
            />
          </div>
          <div class="change">
            <label> confirmpassword:</label>
            <input
              class="input"
              type="password"
              id="cpassword"
              value="As123456"
              pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"         
              title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters"
              required
            />
          </div>
<div class="change">
          <label for="role">Role:</label>
          <select id="role">
            <option value="user">User</option>
            <option value="admin">Admin</option>
            
            surveyor
          </select>
          </div>
          <button type="submit" class="btn">submit</button>
        </form>


        <!-- <button id = "google" >continue with google</button> -->
      </div>
    </div>
   

    
    <script>

let form = document.getElementById("form");
form.addEventListener("submit", function (event) {
  event.preventDefault();
  const fname = document.getElementById("fname").value;
  const mname = document.getElementById("mname").value;
  const Lname = document.getElementById("Lname").value;
  const email = document.getElementById("email").value;
  const phnumber = document.getElementById("phnumber").value;
  const age = document.getElementById("age").value;
  const role = document.getElementById("role").value;
  const password = document.getElementById("password").value;
  const confirmpassword = document.getElementById("cpassword").value;
  let id = self.crypto.randomUUID();

  let userdata = {
    fname,
    mname,
    Lname,
    phnumber,
    age,
    role,
    email: email.toLowerCase(),
    password,
    cpassword: confirmpassword,
    id,
  };

  // let info = JSON.parse(localStorage.getItem("list"));
  // let isSurveyor = false;

  // for (let i = 0; i < info.length; i++) {
  //   if (email === info[i].mail) {
  //     isSurveyor = true;
  //     break;
  //   }
  // }

  // if (isSurveyor === false) {
  //   alert("You are not a surveyor");
  //   return;
  // }

  if (password !== confirmpassword) {
    alert("Password doesn't match");
    return;
  }

  // let validation = JSON.parse(localStorage.getItem("user"));
  // let isEmailExist = false;

  // if (validation !== null) {
  //   for (let i = 0; i < validation.length; i++) {
  //     if (email === validation[i].email) {
  //       isEmailExist = true;
  //       break;
  //     }
  //   }
  // }

  // if (isEmailExist) {
  //   alert("Email already exists");
  //   return;
  // }

  // if (role === "surveyor") {
  //   saveUser(userdata);
  //   window.location.href = "./loginsurveyor.html";
  // } 
   if (role === "admin") {
    if (email === "jayaprakash.jaisankar@fssa.freshworks.com") {
      saveUser(userdata);
      window.location.href = "./loginadmin.html";
    } else {
      alert("You are not an admin");
    }
  } else {
    saveUser(userdata);
    window.location.href = "./login.html";
  }
});

function saveUser(userdata) {
  let userList = JSON.parse(localStorage.getItem("user")) || [];
  userList.push(userdata);
  localStorage.setItem("user", JSON.stringify(userList));
}


    </script>
    
  
  </body>
</html>
